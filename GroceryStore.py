import arcpy
import datetime
import re
#(Monday - 0, Tuesday - 1, Wednesday - 2, Thursday - 3, Friday - 4, Saturday - 5, Sunday - 6)
currentDate= datetime.datetime.today().weekday()
currentTime = str(datetime.datetime.now().strftime("%H:%M:%S"))
print(currentTime)

dict = {"0": {"11510 BROADWAY ST": ["09:00:00", "19:00:00"],
              "3412 BROADWAY ST": ["09:00:00", "19:00:00"],
              "6202 BROOKSIDE RD": ["06:00:00", "22:00:00"],
              "7121 BROADWAY ST": ["07:00:00", "20:00:00", "07:00:00", "08:00:00"],
              "2732 BROADWAY ST": ["08:00:00", "19:30:00"],
              "2710 PEARLAND PKWY": ["08:00:00", "20:00:00", "07:00:00", "08:00:00"],
              "2805 BUSINESS CENTER DR": ["08:00:00", "20:00:00", "07:00:00", "08:00:00"],
              "11003 SHADOW CREEK PKWY": ["07:00:00", "22:00:00"],
              "3245 BROADWAY ST": ["07:00:00", "22:00:00"],
              "8323 BROADWAY ST": ["07:00:00", "22:00:00"],
              "5304 BROADWAY ST":["07:00:00", "23:00:00"],
              "7206 BROADWAY ST": ["00:00:00", "23:59:59"],
              "2817-313 MILLER RANCH RD": ["00:00:00", "00:00:00"],
              "10228 BROADWAY ST": ["07:00:00", "21:00:00"],
              "2718 OLD CHOCOLATE BAYOU RD": ["07:00:00", "22:00:00"],
              "10505 BROADWAY ST": ["07:00:00", "20:30:00"],
              "1919 MAIN ST": ["06:00:00", "20:30:00"],
              "1710 BROADWAY ST": ["07:00:00", "20:30:00"],
              "12631 BROADWAY ST": ["07:00:00", "20:30:00"],
              "3500 BUSINESS CENTER DR": ["10:00:00", "18:30:00"],
              "15800 SOUTH FWY S": ["09:00:00", "20:00:00"]},

        "1": {"11510 BROADWAY ST": ["09:00:00", "19:00:00", "08:30:00", "09:00:00"],
              "3412 BROADWAY ST": ["09:00:00", "19:00:00", "08:30:00", "09:00:00"],
              "6202 BROOKSIDE RD": ["06:00:00", "22:00:00"],
              "7121 BROADWAY ST": ["08:00:00", "20:00:00", "07:00:00", "08:00:00"],
              "2732 BROADWAY ST": ["08:00:00", "19:30:00"],
              "2710 PEARLAND PKWY": ["08:00:00", "20:00:00", "07:00:00", "08:00:00"],
              "2805 BUSINESS CENTER DR": ["08:00:00", "20:00:00", "07:00:00", "08:00:00"],
              "11003 SHADOW CREEK PKWY": ["07:00:00", "22:00:00"],
              "3245 BROADWAY ST": ["07:00:00", "22:00:00"],
              "8323 BROADWAY ST": ["07:00:00", "22:00:00"],
              "5304 BROADWAY ST":["07:00:00", "23:00:00"],
              "7206 BROADWAY ST": ["00:00:00", "23:59:59"],
              "2817-313 MILLER RANCH RD": ["11:00:00", "19:00:00"],
              "10228 BROADWAY ST": ["07:00:00", "21:00:00", "07:00:00", "09:00:00"],
              "2718 OLD CHOCOLATE BAYOU RD": ["07:00:00", "20:00:00"],
              "10505 BROADWAY ST": ["07:00:00", "20:30:00", "06:00:00", "07:00:00"],
              "1919 MAIN ST": ["07:00:00", "20:30:00", "06:00:00", "07:00:00"],
              "1710 BROADWAY ST": ["07:00:00", "20:30:00", "06:00:00", "07:00:00"],
              "12631 BROADWAY ST": ["07:00:00", "20:30:00", "06:00:00", "07:00:00"],
              "3500 BUSINESS CENTER DR": ["10:00:00", "18:30:00"],
              "15800 SOUTH FWY S": ["09:00:00", "20:00:00"]},

         "2": {"11510 BROADWAY ST": ["09:00:00", "19:00:00", "08:30:00", "09:00:00"],
              "3412 BROADWAY ST": ["09:00:00", "19:00:00", "08:30:00", "09:00:00"],
              "6202 BROOKSIDE RD": ["06:00:00", "22:00:00"],
              "7121 BROADWAY ST": ["08:00:00", "20:00:00", "07:00:00", "08:00:00"],
              "2732 BROADWAY ST": ["08:00:00", "19:30:00"],
              "2710 PEARLAND PKWY": ["08:00:00", "20:00:00", "07:00:00", "08:00:00"],
              "2805 BUSINESS CENTER DR": ["08:00:00", "20:00:00", "07:00:00", "08:00:00"],
              "11003 SHADOW CREEK PKWY": ["07:00:00", "22:00:00"],
              "3245 BROADWAY ST": ["07:00:00", "22:00:00"],
              "8323 BROADWAY ST": ["07:00:00", "22:00:00"],
              "5304 BROADWAY ST":["07:00:00", "23:00:00"],
              "7206 BROADWAY ST": ["00:00:00", "23:59:59"],
              "2817-313 MILLER RANCH RD": ["11:00:00", "19:00:00"],
              "10228 BROADWAY ST": ["07:00:00", "21:00:00"],
              "2718 OLD CHOCOLATE BAYOU RD": ["07:00:00", "20:00:00"],
              "10505 BROADWAY ST": ["07:00:00", "20:30:00"],
              "1919 MAIN ST": ["07:00:00", "20:30:00"],
              "1710 BROADWAY ST": ["07:00:00", "20:30:00"],
              "12631 BROADWAY ST": ["07:00:00", "20:30:00"],
              "3500 BUSINESS CENTER DR": ["10:00:00", "18:30:00"],
              "15800 SOUTH FWY S": ["09:00:00", "20:00:00"]},

         "3": {"11510 BROADWAY ST": ["09:00:00", "19:00:00"],
              "3412 BROADWAY ST": ["09:00:00", "19:00:00"],
              "6202 BROOKSIDE RD": ["06:00:00", "22:00:00"],
              "7121 BROADWAY ST": ["08:00:00", "20:00:00", "07:00:00", "08:00:00"],
              "2732 BROADWAY ST": ["08:00:00", "19:30:00"],
              "2710 PEARLAND PKWY": ["08:00:00", "20:00:00", "07:00:00", "08:00:00"],
              "2805 BUSINESS CENTER DR": ["08:00:00", "20:00:00", "07:00:00", "08:00:00"],
              "11003 SHADOW CREEK PKWY": ["07:00:00", "22:00:00"],
              "3245 BROADWAY ST": ["07:00:00", "22:00:00"],
              "8323 BROADWAY ST": ["07:00:00", "22:00:00"],
              "5304 BROADWAY ST":["07:00:00", "23:00:00"],
              "7206 BROADWAY ST": ["00:00:00", "23:59:59"],
              "2817-313 MILLER RANCH RD": ["11:00:00", "19:00:00"],
              "10228 BROADWAY ST": ["07:00:00", "21:00:00", "07:00:00", "09:00:00"],
              "2718 OLD CHOCOLATE BAYOU RD": ["07:00:00", "20:00:00"],
              "10505 BROADWAY ST": ["07:00:00", "20:30:00"],
              "1919 MAIN ST": ["07:00:00", "20:30:00"],
              "1710 BROADWAY ST": ["07:00:00", "20:30:00"],
              "12631 BROADWAY ST": ["07:00:00", "20:30:00"],
              "3500 BUSINESS CENTER DR": ["10:00:00", "18:30:00"],
              "15800 SOUTH FWY S": ["09:00:00", "20:00:00"]},

         "4": {"11510 BROADWAY ST": ["09:00:00", "19:00:00"],
              "3412 BROADWAY ST": ["09:00:00", "19:00:00"],
              "6202 BROOKSIDE RD": ["06:00:00", "22:00:00"],
              "7121 BROADWAY ST": ["08:00:00", "20:00:00", "07:00:00", "08:00:00"],
              "2732 BROADWAY ST": ["08:00:00", "19:30:00"],
              "2710 PEARLAND PKWY": ["08:00:00", "20:00:00", "07:00:00", "08:00:00"],
              "2805 BUSINESS CENTER DR": ["08:00:00", "20:00:00", "07:00:00", "08:00:00"],
              "11003 SHADOW CREEK PKWY": ["07:00:00", "22:00:00"],
              "3245 BROADWAY ST": ["07:00:00", "22:00:00"],
              "8323 BROADWAY ST": ["07:00:00", "22:00:00"],
              "5304 BROADWAY ST":["07:00:00", "23:00:00"],
              "7206 BROADWAY ST": ["00:00:00", "23:59:59"],
              "2817-313 MILLER RANCH RD": ["11:00:00", "19:00:00"],
              "10228 BROADWAY ST": ["07:00:00", "21:00:00"],
              "2718 OLD CHOCOLATE BAYOU RD": ["07:00:00", "20:00:00"],
              "10505 BROADWAY ST": ["07:00:00", "20:30:00"],
              "1919 MAIN ST": ["07:00:00", "20:30:00"],
              "1710 BROADWAY ST": ["07:00:00", "20:30:00"],
              "12631 BROADWAY ST": ["07:00:00", "20:30:00"],
              "3500 BUSINESS CENTER DR": ["10:00:00", "18:30:00"],
              "15800 SOUTH FWY S": ["09:00:00", "20:00:00"]},

        "5": {"11510 BROADWAY ST": ["09:00:00", "19:00:00"],
              "3412 BROADWAY ST": ["09:00:00", "19:00:00"],
              "6202 BROOKSIDE RD": ["06:00:00", "22:00:00"],
              "7121 BROADWAY ST": ["08:00:00", "20:00:00", "07:00:00", "08:00:00"],
              "2732 BROADWAY ST": ["08:00:00", "19:30:00"],
              "2710 PEARLAND PKWY": ["08:00:00", "20:00:00", "07:00:00", "08:00:00"],
              "2805 BUSINESS CENTER DR": ["08:00:00", "20:00:00", "07:00:00", "08:00:00"],
              "11003 SHADOW CREEK PKWY": ["07:00:00", "22:00:00"],
              "3245 BROADWAY ST": ["07:00:00", "22:00:00"],
              "8323 BROADWAY ST": ["07:00:00", "22:00:00"],
              "5304 BROADWAY ST":["07:00:00", "23:00:00"],
              "7206 BROADWAY ST": ["00:00:00", "23:59:59"],
              "2817-313 MILLER RANCH RD": ["11:00:00", "19:00:00"],
              "10228 BROADWAY ST": ["07:00:00", "21:00:00"],
              "2718 OLD CHOCOLATE BAYOU RD": ["07:00:00", "20:00:00"],
              "10505 BROADWAY ST": ["07:00:00", "20:30:00"],
              "1919 MAIN ST": ["07:00:00", "20:30:00"],
              "1710 BROADWAY ST": ["07:00:00", "20:30:00"],
              "12631 BROADWAY ST": ["07:00:00", "20:30:00"],
              "3500 BUSINESS CENTER DR": ["09:30:00", "18:00:00"],
              "15800 SOUTH FWY S": ["09:00:00", "20:00:00"]},

        "6": {"11510 BROADWAY ST": ["09:00:00", "19:00:00"],
              "3412 BROADWAY ST": ["09:00:00", "19:00:00"],
              "6202 BROOKSIDE RD": ["06:00:00", "22:00:00"],
              "7121 BROADWAY ST": ["08:00:00", "20:00:00", "07:00:00", "08:00:00"],
              "2732 BROADWAY ST": ["08:00:00", "19:30:00"],
              "2710 PEARLAND PKWY": ["08:00:00", "20:00:00", "07:00:00", "08:00:00"],
              "2805 BUSINESS CENTER DR": ["08:00:00", "20:00:00", "07:00:00", "08:00:00"],
              "11003 SHADOW CREEK PKWY": ["07:00:00", "22:00:00"],
              "3245 BROADWAY ST": ["07:00:00", "22:00:00"],
              "8323 BROADWAY ST": ["07:00:00", "22:00:00"],
              "5304 BROADWAY ST":["00:00:00", "00:00:00"],
              "7206 BROADWAY ST": ["00:00:00", "23:59:59"],
              "2817-313 MILLER RANCH RD": ["11:00:00", "19:00:00"],
              "10228 BROADWAY ST": ["07:00:00", "21:00:00"],
              "2718 OLD CHOCOLATE BAYOU RD": ["07:00:00", "20:00:00"],
              "10505 BROADWAY ST": ["07:00:00", "20:30:00"],
              "1919 MAIN ST": ["07:00:00", "20:30:00"],
              "1710 BROADWAY ST": ["07:00:00", "20:30:00"],
              "12631 BROADWAY ST": ["07:00:00", "20:30:00"],
              "3500 BUSINESS CENTER DR": ["10:30:00", "18:00:00"],
              "15800 SOUTH FWY S": ["10:00:00", "18:00:00"]},
        }

fields = ["USER_Address", "USER_Status"]
points = "\\\\GISAPP\\Workspace\\sdeFiles\\Horizon_Owner.sde\\Horizon.DBO.EOC\\Horizon.DBO.GroceryStores"
with arcpy.da.UpdateCursor(points, fields) as Ucur:
    for Urow in Ucur:
        for key, value in dict.items():
            if key == str(currentDate):
                for k, v in value.items():
                    if Urow[0] == k:
                        if len(v) > 2 and currentTime >= v[2] and currentTime <= v[3]:
                            print(Urow[0])
                            Urow[1] = "Special Hours"
                            Ucur.updateRow(Urow)
                        elif currentTime >= v[0] and currentTime <= v[1]:
                            Urow[1] = "Open"
                            Ucur.updateRow(Urow)
                        else:
                            print(Urow[0])
                            Urow[1] = "Closed"
                            Ucur.updateRow(Urow)
del Ucur                       
print(".")
                    